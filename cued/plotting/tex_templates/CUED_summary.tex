\documentclass[11pt, a4paper]{scrartcl}
\usepackage{xcolor}
\usepackage[colorlinks=true,allcolors=blue,pdfborder={0 0 0},pdfstartview={FitV},breaklinks,linktocpage]{hyperref}
\usepackage{color,amsmath,amsfonts,amssymb}
\usepackage[utf8]{inputenc}
\usepackage{enumitem}%für mehrspaltige Aufzählungen
\usepackage[ngerman, english]{babel}
\usepackage{epsfig}
\usepackage{pstricks}
\usepackage{graphics}
\graphicspath{{Figures/}}
\usepackage{bbm}
%\usepackage{showlabels}
\usepackage{siunitx}
\usepackage[labelfont=bf]{caption}
%\usepackage{nonfloat}
\usepackage{booktabs}%für Tabellen
\usepackage{pgffor} %for loops
\usepackage{ifthen} %for if
\usepackage{pgfplots} %für Plots
\pgfplotsset{
compat=1.5,
tick label style={font=\small},
every axis/.append style={line width=0.8pt, tick style={line width=0.7pt}}
} %für richtigen Abstand der labels
\usetikzlibrary{shapes,arrows,fit,calc,positioning,arrows}
\usepackage[
  textheight=25cm,
left=2.3cm,
right=2.3cm,
headheight=25pt,
  includehead,includefoot,
  heightrounded,
]{geometry}
\makeatletter
\def\input@path{{./Figures/}}
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyfoot{}
\fancyhead{}
% \renewcommand{\chaptermark}[1]
% {\markboth{{\chaptername\ \thechapter:\  #1}}{}}
% \renewcommand{\sectionmark}[1]
% {{\markright{ \thesection\ #1}}} 
%\renewcommand{\sectionmark}[1]{\markboth{#1}{}}

%\renewcommand\sectionmark[1]{\markright{#1}}
%\renewcommand{\thesection}{\arabic{section}.}
\fancyhead[L]{}
\fancyhead[R]{\thepage}
\fancyhead[C]{\nouppercase{\leftmark}}
%\fancyhead[C]{\nouppercase{\rightmark}}


%\usepackage{sectsty}
\usepackage{url}
%\usepackage{breakurl}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{tikzpagenodes}

\definecolor{darkgreen}{rgb}{0.0,0.6,0.0}
\definecolor{shadedgreen}{rgb}{0.8,0.95,0.8}
\definecolor{shadedblue}{rgb}{0.85,0.85,1.0}
\newlength\figureheight 
\newlength\figurewidth


\usepackage[varg]{txfonts} %font/Schrift
%\usepackage{csquotes}
% \usepackage[minnames=3,maxnames=30,backend=biber,natbib=true,sorting=none,citestyle=numeric-comp,giveninits=true]{biblatex}
% \addbibresource{Literature.bib}
% %\setlength\bibitemsep{0.5em}
% \setlength{\biblabelsep}{0.4em}

% \DeclareFieldFormat{pages}{#1}
% \DeclareFieldFormat{journaltitle}{#1}
% \DeclareFieldFormat{eprint}{#1}
% \DeclareFieldFormat[article]{title}{\it#1\isdot}

% \DeclareBibliographyDriver{article}{
% \printnames{author}, \printfield{title},
% \href{http://dx.doi.org/\thefield{doi}}
% {\printfield{journaltitle} 
% \textbf{\printfield{volume}}, \printfield{pages} 
% (\printfield{year})}.}

% \DeclareBibliographyDriver{misc}{
% \printnames{author}, \printfield{title},
% \href{https://arxiv.org/abs/\thefield{eprint}}{
% arXiv preprint, arXiv:\printfield{eprint}  (\printfield{year})}.}

% \DeclareBibliographyDriver{inbook}{\hspace{-0.1cm}
% \printnames{author},
% \printfield{title},
% in \printfield{booktitle}.
% \printlist{publisher}
% (\printfield{year}).
% }


% \renewbibmacro*{name:andothers}{% Based on name:andothers from biblatex.def
%   \ifboolexpr{
%     test {\ifnumequal{\value{listcount}}{\value{liststop}}}
%     and
%     test \ifmorenames
%   }
%     {\ifnumgreater{\value{liststop}}{1}
%       {\finalandcomma}
%       {}%
%      \andothersdelim\bibstring[\emph]{andothers}}
%     {}}

\setenumerate[1]{label=[\arabic*],ref=\arabic*}
\newcommand{\paper}[4]{\item #1, \,\textit{#2}, \,\href{#3}{#4}.\\[-1.4em]}

\definecolor{darkgreen}{rgb}{0.0,0.5,0.0}

% Aliases
\input{CUED_aliases.tex}

\begin{document}

\pagenumbering{Roman}

\begin{titlepage}\pdfbookmark[0]{Title}{Title}
  \sffamily
  \begin{center}
{
\includegraphics[width=9cm]{logo.pdf}
\\[5em]
\Huge \bfseries Output summary of the CUED program}
\\[3em]\large
The CUED program is developed and maintained by:
\\[3em]
Chair of Computational Condensed Matter Theory
  \\[0.5em]
Institute of Theoretical Physics
  \\[0.5em]
University of Regensburg
  \\[0.5em]
Universitätsstraße 31
  \\[0.5em]
D\,-\,93053 Regensburg
  \\[0.5em]
Germany
\\[3em]
Date of execution: \today
  \\[0.5em]
Run time: PH-RUN s
  \\[0.5em]
Number of used processors: PH-MPIRANKS
\\[3em]
  \end{center}{\large
  Contact:
  \\[1em]
    Jan Wilhelm
      \\[0.5em]
    Ferdinand Evers
  \\[3em]
  Contributors (in alphabetic order): 
  \\[1em]
  Jack Crewse
  \\[0.5em]
    Maximilian Graml
  \\[0.5em]
  Patrick Grössing
  \\[0.5em]
  Adrian Seith
  }
\end{titlepage}







\pagenumbering{arabic}
\pagestyle{plain}




\pdfbookmark[0]{Contents}{Contents}
\tableofcontents


\pagestyle{fancy}
\section{How to cite and reference CUED}
When using the CUED software package, please reference to CUED by citing the following publication:
\begin{enumerate}[leftmargin=*]

\paper{J.~Wilhelm, P.~Grössing, A.~Seith, J.~Crewse, M.~Nitsch, L.~Weigl, C.~Schmid, and F.~Evers}{Semi\-con\-duc\-tor-Bloch Formalism: Derivation and Application to High-Harmonic Generation from Dirac Fermions}{https://doi.org/10.1103/PhysRevB.103.125419}{ 
Phys.~Rev.~B~\,\textbf{103}, 125419 (2021)}
\label{Wilhelm2021}

\end{enumerate}

\section{Electric-field pulse}
\begin{figure}[b!]
\centering
\setlength\figureheight{7.5cm} 
\setlength\figurewidth{7.5cm}
\input{Efield.tikz}\hfill\input{Afield.tikz}
\caption{Left: Electric driving field~$E(t)$, right: Gauge field~$A(t)$ from Eq.~\eqref{e2}.}
    \label{fig:Efield}
\end{figure}
\iftrue
The following electric driving field is employed in the simulation:
\begin{align}
    \bE(t)  = E(t)\,\hat{e}_\phi
    \;,\hspace{2em}
    E(t) = E_0\,    \sin\Big(2\pi f_0\,(1+f_\text{chirp} t)\,t + \varphi\Big)\, e^{-t^2/\sigma^2}\;.
    \label{e1}
\end{align}
The pulse is sketched in Fig.~\ref{fig:Efield}. 
%
The following parameters are used in the simulation:
\begin{itemize}
    \item Amplitude: $E_0 = PH-E0$\,MV/cm
    \item PH-EFIELD-DIRECTION
    \item Pulse frequency: $f_0 = PH-FREQ$\,THz
    \item Chirp: $f_\text{chirp} = PH-CHIRP$\,THz
    \item Carrier-envelope phase: $\varphi = PH-CEP$
    \item $\sigma = PH-SIGMA$\,fs, full width at half maximum (FWHM) of the Gaussian envelope = PH-FWHM\,fs
\end{itemize}
\else 
A user-defined pulse is used. 
%
It is sketched in Fig.~\ref{fig:Efield}. 
\fi
The gauge field~$\bA(t)\eqt A(t)\,\hat{e}_\phi$ follows from~$\dot\bA(t)\eqt -\bE(t)$. We compute $A(t)$ for the sketch in Fig.~\ref{fig:Efield} as
\begin{align}
    \dot A(t) = -E(t) \hspace{2em}\Rightarrow\hspace{2em}
    A(t) = -\int\limits_{-\infty}^t E(t')\,dt'\;. \label{e2}
\end{align}


\section{Brillouin zone and \textit{k}-point grid}
A PH-BZ as Brillouin zone (BZ) with a mesh size of PH-NK1\,$\times$\,PH-NK2 is used. 
%
The BZ and a PH-SMALLNK1\,$\times$\,PH-SMALLNK2 $k$-point mesh is sketched in Fig.~\ref{fig:kp}.
%
Please note that in the params.py file, the BZ size (in case of a rectangular BZ) and the lattice parameter~$a$ (in case of a hexagonal BZ) are both given in atomic units, while the output here is in $1/${\AA} (note: 1 atomic length unit = $1 a_0$ = 0.529\,\AA, $a_0$:~Bohr radius, 1 atomic inverse length unit = 1/(0.529\,\AA) = 1.890\,\AA$^{-1}$). 
%
\begin{figure}
\centering
\setlength\figureheight{1.00000000000000000000\textwidth} 
\setlength\figurewidth{0.87\textwidth}
\input{BZ.tikz}
\caption{Brillouin zone (BZ) and PH-SMALLNK1\,$\times$\,PH-SMALLNK2 $k$-point mesh.
%
The BZ is indicated by the black PH-BZ.
%
Gray points indicate $k$-points and if length gauge is used, colored lines will indicate $k$-points that are coupled via  the term $\bE(t)\cdot \nabla_\bk$.
%
The green and red line at the top left corner sketch ${\color{darkgreen}k_\text{max}}\coloneqqt\hat{e}_\phi\max (-qA(t)/\hbar)$ and ${\color{red}k_\text{min}}\coloneqqt\hat{e}_\phi\min (-qA(t)/\hbar)$ indicating the extremal excursion of  electrons in the BZ.  
}
    \label{fig:kp}
\end{figure}


\section{Hamiltonian, bandstructure and dipoles}
\begin{figure}
\centering
\setlength\figureheight{6.5cm} 
\setlength\figurewidth{\textwidth}
\input{bandstructure.tikz}
\\[2em]
\input{abs_dipole.tikz}
\\[2em]
\input{proj_dipole.tikz}
\caption{Top: Band structure~$\epsilon_n(\bk)$ as computed from the Hamiltonian~$h(\bk)$, see Eq.~\eqref{e3}. 
%
Middle and bottom: Absolute value of the dipoles and projection of the dipole onto the axis of the electric field [this projection enters the semiconductor Bloch equations, Eq.~\eqref{e5}].
%
Dipoles below $10^{-10}$\,{\AA} are not displayed.
}
    \label{fig:bandstructuredipole}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{dipoles.pdf}
    \caption{Real and imaginary part of dipole matrix elements.}
    \label{fig:dipoles}
\end{figure}

The $n$-band Hamiltonian $h(\bk)$ is an $n\timest n$ matrix that is given as an input. 
%
Diagonalizing $h(\bk)$ yields the band structure and the eigenvectors~$\ketunk$,
\begin{align}
    h(\bk)\,\ketunk = \epsilon_n(\bk)\,\ketunk\,.
    \label{e3}
\end{align}
Dipoles are computed from
\begin{align}
\mathbf{d}_{nn'}(\bk) &=  iq\, \braunk \,\partial_{\bk}\,\ketunkprime\,,
\end{align}
where $q\eqt {-}\sd{e}$ is the electron charge.
%
The band structure and the dipoles are sketched in Fig.~\ref{fig:bandstructuredipole} and~\ref{fig:dipoles}. 
%{\color{red}How is the complex phase of $\ketunk$ made continuous?}

\section{Time evolution of the density matrix}
In case you choose the length gauge (\texttt{gauge = 'length'}, that is also the default) and $1/T_1\eqt 0$, we solve semiconductor Bloch equations in the length gauge, Eq.~(50) in Ref.~[\ref{Wilhelm2021}]:
\begin{align}
    \left[
    \frac{\partial}{\partial t}
    {+}q\bE(t)\frac{\partial}{\partial \bk}
    \right]\rhonnprime = 
    \left[i\sd(\epsilon_{n'}(\bk){-}\epsilon_{n}(\bk))
   \sd {-}\sd\frac{1{-}\sd\delta_{nn'}}{T_2}\right]\rhonnprime
    -i\sd \bE(t){\sum_{\un}}
    \big(\rho_{n\un}(\bk;t) \mathbf{d}_{\un n'}(\bk)
  \sd  {-} \sd \mathbf{d}_{n\un}(\bk)\rho_{\un n'}(\bk;t)
    \big)\label{e5}
\end{align}
with a dephasing time $T_2\eqt PH-T2$\,fs. 
%
The time evolution of the density matrix is visualized in Figs.~\ref{fig:dm00}\,--\,\ref{fig:Imdm01}.
\\\\
\foreach \bandindex in {0,...,1}{
\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{dm_\bandindex\bandindex.pdf}
    \caption{Time evolution of the \bandindex-\bandindex{} diagonal entry of the density matrix.}
    \label{fig:dm\bandindex\bandindex}
\end{figure}
}

\foreach \bandindex in {0,...,1}{
\foreach \jbandindex in {0,...,1}{
\ifnum \bandindex<\jbandindex
{
\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{Re_dm_\bandindex\jbandindex.pdf}
    \caption{Time evolution of the real part of the \bandindex-\jbandindex{} offdiagonal entry of the density matrix.}    \label{fig:Redm\bandindex\jbandindex}
\end{figure}
\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{Im_dm_\bandindex\jbandindex.pdf}
    \caption{Time evolution of the imaginary part of the \bandindex-\jbandindex{} offdiagonal entry of the density matrix.}       \label{fig:Imdm\bandindex\jbandindex}
\end{figure}
}
\fi
}
}

\section{Time-dependent current}
\begin{figure}
\centering
\setlength\figureheight{7.5cm} 
\setlength\figurewidth{7.5cm}
\input{j_E_dir.tikz}\hfill\input{j_ortho.tikz}
\\
\setlength\figureheight{6.5cm} 
\setlength\figurewidth{\textwidth}
\input{j_E_dir_whole_time.tikz}
\\
\input{j_ortho_whole_time.tikz}
\caption{Components of the time-dependent current~$\bj(t)$: top left: parallel to the driving field, top right: orthogonal to the driving field, see Eq.~\eqref{currentcomp}.
Middle and bottom: Current over the whole time window of the simulation. }
    \label{fig:current}
\end{figure}
In case you choose the length gauge (\texttt{gauge = 'length'}, that is also the default), the current is computed from Eq.~(67) in Ref.~[\ref{Wilhelm2021}] as
\begin{align}
 \bj(t)  =
q\sum_{nn'} \intbzdkpi
\ \langle u_{n\bk} |  \frac{\partial h(\bk)}{\partial \bk} | u_{n'\bk}\rangle \ \rhonprimen\;.\label{current}
\end{align} 
The matrix element $ \langle u_{n\bk} |  (\partial_\bk h(\bk)) | u_{n'\bk}\rangle$ can be computed from Eq.~(68) in Ref.~[\ref{Wilhelm2021}] as
\begin{align}
   \langle u_{n\bk} |  \frac{\partial h(\bk)}{\partial \bk} | u_{n'\bk}\rangle  = \delta_{nn'}\partial_\bk\epsilon_n(\bk) 
   +\frac{i}{q}\, \bd_{nn'}(\bk)\,(\epsilon_n(\bk)-\epsilon_{n'}(\bk)) \;.
\end{align}
%
In our case, the current is a two-dimensional vector. 
%
For generating meaningful plots, we project the current onto the axis~$\hat{e}_\phi$ of the incoming E-field and its orthogonal direction $\hat{e}_{\phi+\pi/2}$:
\begin{align}
    j_{\parallel}(t) = \hat{e}_\phi\;\bj(t)\;,\hspace{2em}
    j_{\bot}(t) = \hat{e}_{\phi+\pi/2}\;\bj(t)\;, 
    \label{currentcomp}
\end{align}
and we recover 
\begin{align}
\bj(t)\eqt\hat{e}_\phi\, j_{\parallel}(t)\pt\hat{e}_{\phi+\pi/2}\,j_{\bot}(t)\;.
    \label{currentdecomp}
\end{align}
The time-dependent current is shown in Fig.~\ref{fig:current}. 



\section{Frequency-resolved emission spectrum}
\begin{figure}
\centering
\setlength\figureheight{7.0cm} 
\setlength\figurewidth{0.95\textwidth}
\input{Emission_total.tikz}
\\[1.0em]
\input{Emission_para_ortho.tikz}
\\[1.0em]
%\input{Emission_total_hann_parzen.tikz}
\input{Emission_para_ortho_full_range.tikz}
\caption{Top: Total emission intensity from the irradiated material computed from Eq.~\eqref{emission}. 
%
Middle and bottom: Emission intensity of the polarization parallel and orthogonal to the incoming electric field from the irradiated material computed from Eq.~\eqref{emissiondecomp2}.
%
The data is displayed using two different frequency scales. 
%
The frequency is given by $f\eqt\w/(2\pi)$.
}
    \label{fig:emission}
\end{figure}

Experiments measure the  frequency resolved emission intensity~$I$, which is computed by Eq.~(53) in Ref.~[\ref{Wilhelm2021}]
\begin{align}
I(\w) &=
\frac{\w^2}{3c^3}\,|\bj(\w)|^2\;, \label{emission}
\end{align}
where $c$ is the speed of light and $\bj(\w)$ is the Fourier transform of the current $\bj(t)$.
%
Since the current $\bj(t)$ is not periodic in time, short-time Fourier transform (STFT) is used with a window function~$w(t)$,
\begin{align}
    \bj(\w) = \frac{1}{\sqrt{2\pi}}\int\limits_{-t_0}^{t_0}\,w(t)\;\bj(t)\;e^{-i\w t}\,.
\end{align}
%
As window, a Hann, Parzen and Gaussian window are available in the code. 
%
The emission is sketched in Fig.~\ref{fig:emission}.
%
%
When inserting Eq.~\eqref{currentdecomp} in the frequency domain, we have
\begin{align}
I(\w) &=
\frac{\w^2}{3c^3}\,\Big(\,|\,  j_\parallel(\w)\sd|^2
+ |\,  j_\bot(\w)\sd|^2 \,\Big)
\;, \label{emissiondecomp}
\end{align}
that motivates the definitions
\begin{align}
I_\parallel(\w) =
\frac{\w^2}{3c^3}\, |\sd  j_\parallel(\w)\sd|^2\;,
\hspace{2em}
I_\bot(\w) =
\frac{\w^2}{3c^3}\, |\sd  j_\bot(\w)\sd|^2\;. \label{emissiondecomp2}
\end{align}
We recover $I(\w)\eqt I_\parallel(\w)\,{+}\sd I_\bot(\w)$.
%
The emission intensity of parallel and orthogonal polarized light is sketched in Fig.~\ref{fig:emission}.



\section{How to cite and reference CUED}
When using the CUED software package, please reference to CUED by citing the following publication:
\begin{enumerate}[leftmargin=*]

\paper{J.~Wilhelm, P.~Grössing, A.~Seith, J.~Crewse, M.~Nitsch, L.~Weigl, C.~Schmid, and F.~Evers}{Semi\-con\-duc\-tor-Bloch Formalism: Derivation and Application to High-Harmonic Generation from Dirac Fermions}{https://doi.org/10.1103/PhysRevB.103.125419}{ 
Phys.~Rev.~B~\,\textbf{103}, 125419 (2021)}
\label{Wilhelm2021}

\end{enumerate}

\end{document}
